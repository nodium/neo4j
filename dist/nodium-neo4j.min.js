!function e(t,n,o){function r(a,d){if(!n[a]){if(!t[a]){var s="function"==typeof require&&require;if(!d&&s)return s(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[a]={exports:{}};t[a][0].call(h.exports,function(e){var n=t[a][1][e];return r(n?n:e)},h,h.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e){!function(t){"use strict";e("./nodium-neo4j")(t.Nodium)}(window)},{"./nodium-neo4j":3}],2:[function(e,t){t.exports=function(e,t){"use strict";var n,o=e.graph,r=e.model,i=e.transformer,a=e.event.NodeEvent,d=e.event.EdgeEvent,s={host:"localhost",port:7474,version:2};o.Neo4jAPI=e.createClass({construct:function(e){this.options=t.extend({},s,e),n=this},createUrl:function(e){var t=this.options,n=(t.host,t.port),o="http://"+this.options.host;return n&&(o+=":"+n),e&&(o+=e),o},nodeUrl:function(e){var t="/db/data/node";return e&&(t+="/"+e),this.createUrl(t)},edgeUrl:function(e){var t="/db/data/relationship";return e&&(t+="/"+e),this.createUrl(t)},cypherUrl:function(){return this.createUrl("/db/data/cypher")},initialize:function(){t(this.kernel).on(a.CREATED,this.handleNodeCreated.bind(this)),t(this.kernel).on(a.DESTROYED,this.handleNodeDeleted.bind(this)),t(this.kernel).on(d.CREATED,this.handleEdgeCreated.bind(this)),t(this.kernel).on(d.DESTROYED,this.handleEdgeDeleted.bind(this)),t(this.kernel).on(a.UPDATED,this.handleNodeUpdated.bind(this)),t(this.kernel).on(a.UPDATED,this.handleNodeLabelUpdated.bind(this))},get:function(e){var n,o={query:"START n=node(*) RETURN n",params:{}},r={query:"START r=relationship(*) RETURN r",params:{}},a=this.cypherUrl();t.post(a,o).done(function(o){t.post(a,r).done(function(t){n=i.neo4j.from(o,t),e(n)})})},handleNodeCreated:function(e,n,o){var r=this.nodeUrl(),a=i.neo4j.toNode(o);t.ajax({url:r,data:a,type:"POST",async:!1}).done(function(e){o._id=i.neo4j.idFromSelf(e.self)})},handleNodeDeleted:function(e,n){var o,r=this.cypherUrl();o={query:"START n=node("+n._id+") OPTIONAL MATCH n-[r]-() DELETE n,r",params:{}},t.post(r,o)},handleEdgeCreated:function(e,n,o,r){var a=this.nodeUrl(o._id)+"/relationships",d={to:this.edgeUrl(r._id),type:n.type};t.post(a,d).done(function(e){n._id=i.neo4j.idFromSelf(e.self)})},handleEdgeDeleted:function(e,n){var o=this.edgeUrl(n._id);t.ajax({url:o,type:"DELETE"})},handleNodeUpdated:function(e,n,o,a){if(a.changed(r.Node.getPropertiesPath())||a.changed("_style")){console.log("api: handling node update"),console.log(o._id);var d=i.neo4j.toNode(o),s=this.nodeUrl(o._id)+"/properties";t.ajax({url:s,type:"PUT",data:d})}},handleNodeLabelUpdated:function(e,n,o,i){if(i.changed(r.Node.getLabelsPath())){console.log("api: handling node label update"),console.log(o._id);var a=this.nodeUrl(o._id)+"/labels";t.ajax({url:a,type:"PUT",contentType:"application/json",data:JSON.stringify(o._labels)})}}})}},{}],3:[function(e,t){t.exports=function(t){var n=t.context.jQuery;e("./api/Neo4jAPI")(t,n),e("./transformer/Neo4jTransformer")(t,n)}},{"./api/Neo4jAPI":2,"./transformer/Neo4jTransformer":4}],4:[function(e,t){t.exports=function(e,t,n){"use strict";var e=e,o=e.model,r=e.transformer;r.Neo4jTransformer=e.createClass(r.AbstractDataTransformer,{construct:function(){r.neo4j=this},idFromSelf:function(e){var t,n=e.lastIndexOf("/");return-1==n?null:t=e.substring(n+1,e.length)},from:function(e,r){for(var i,a,d,s,l,h,u=[],f=[],c={},p=0,g=this.options.map,v=0;v<e.data.length;v++)if(l={},h={},a=e.data[v][0],d=e.data[v][1],a&&c[a.self]===n){for(var N in a.data)g.hasOwnProperty(N)?h[g[N]]=a.data[N]:l[N]=a.data[N];c[a.self]=p,p++,i=o.Node.create(l,d,this.idFromSelf(a.self)),t.extend(i,h),u.push(i)}for(var v=0;v<r.data.length;v++)s=r.data[v][0],s&&f.push({_id:this.idFromSelf(s.self),source:c[s.start],target:c[s.end],type:s.type});return console.log("nodes"),console.log(u),{nodes:u,edges:f}},to:function(e,n){var o,r,i,a,d=[],s=[];if(e)for(var l=0;l<e.length;l++)o=e[l],i=this.getmappedProperties(o),a=t.extend({},o._properties,i),d.push(a);if(n)for(var l=0;l<n.length;l++)r=n[l],s.push(r);return{nodes:d,edges:s}},toNode:function(e){return this.to([e]).nodes[0]}})}},{}]},{},[1]);